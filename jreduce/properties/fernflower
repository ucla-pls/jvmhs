#/usr/bin/env bash


if [ -z "$FERNFLOWER" ]
then 
    echo "Please set \$FERNFLOWER to be the absolute path to the fernflower jar";
    exit -1
fi

input=$1 

output=fernflower

if [ -e "$output" ] 
then 
    rm -r "$output"
fi

mkdir -p $output/src $output/classes


java -jar $FERNFLOWER -dgs=1 $1 $output/src

find "$output/src" -name *.jar -exec unzip -d "$output/src" {} \;

find "$output/src" -name *.java > "$output/sourcefiles.txt"

javac -cp "$classpath":"$output/classes" -d "$output/classes" -sourcepath "$output" @"$output/sourcefiles.txt"
err=$?

if [ "$err" == "1" ]; then
    exit 0
else
    exit 1
fi
